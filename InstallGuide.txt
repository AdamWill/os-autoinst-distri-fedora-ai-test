= OpenQA install guide =

== Install OpenSuse 13.2, default with Gnome ==

* Add online repos before install
* Create partition setup & use the right HDD
* Select Update & Non-OSS repos & Main Update Repository
* Select GNOME desktop
* Create user (test/fedora), make user system administrator
* Disable firewall, enable SSH
* ???
* Profit!



== OpenQA installation ==

sudo su -

# add user
useradd geekotest

# add repos
zypper ar -f obs://devel:openQA/openSUSE_13.2 openQA
zypper ar -f obs://devel:openQA:13.2/openSUSE_13.2 openQA-perl-modules

# install
zypper in openQA
zypper in openQA-worker

# filesystem layout

cd /var/lib/openqa
mkdir pool/1
chown -R geekotest backlog cache factory perl pool share testresults script


# apache
gensslcert
cd /etc/apache2/vhosts.d/
a2enmod headers
a2enmod proxy
a2enmod proxy_http
a2enmod proxy_wstunnel
a2enmod ssl
a2enflag SSL

cp openqa-ssl.conf.template openqa-ssl.conf
cp openqa.conf.template openqa.conf

# edit openqa-common.inc
# replace Order allow deny & Allow from all by sinle line
# Require all granted

# edit openqa-ssl.conf
# un-comment lines starting with #SSL
# replace paths to certificates from 'openqa.{crt,key}' to 'server.{crt,key}'

# OpenID
# edit /etc/openqa/openqa.ini
# uncomment & change:
# [openid]
# provider = https://id.fedoraproject.org/


# services
systemctl enable apache2
systemctl restart apache2
systemctl enable openqa-webui
systemctl restart openqa-webui


curl http://localhost

# login via OpenID - the first one to login is automagically set to be the admin

# Setup Worker
# go to http:/localhost/api_keys & create the keys
# copy the key & secret to /etc/openqa/client.conf
systemctl enable openqa-worker@1
systemctl start openqa-worker@1
# check whether worker is active in the web-ui
